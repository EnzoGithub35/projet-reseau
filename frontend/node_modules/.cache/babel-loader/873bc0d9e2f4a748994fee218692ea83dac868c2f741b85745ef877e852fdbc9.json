{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\enzor\\\\OneDrive\\\\\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B\\\\EPSI\\\\SN2\\\\projet reseau\\\\frontend\\\\src\\\\pages\\\\AdminDashboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useAuth } from \"../context/AuthContext\";\nimport requestsApi from \"../services/requests\";\nimport AdminDemandeList from \"../components/admin/AdminDemandeList\";\nimport AdminDemandeDetail from \"../components/admin/AdminDemandeDetail\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AdminDashboard = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useAuth();\n  const [demandes, setDemandes] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [selected, setSelected] = useState(null);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n  const fetchDemandes = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      const res = await requestsApi.getAll(token, user.id, user.role);\n      setDemandes(res.data);\n    } catch (e) {\n      setError(\"Erreur lors du chargement des demandes\");\n    }\n    setLoading(false);\n  };\n  useEffect(() => {\n    if (user) fetchDemandes();\n    // eslint-disable-next-line\n  }, [user]);\n  const handleAction = async (demande, status) => {\n    setLoading(true);\n    setError(\"\");\n    setSuccess(\"\");\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      await requestsApi.update(demande.id, {\n        status\n      }, token);\n      setSuccess(\"Demande mise à jour\");\n      fetchDemandes();\n    } catch (e) {\n      var _e$response, _e$response$data;\n      setError(((_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"Erreur lors de la mise à jour\");\n    }\n    setLoading(false);\n  };\n  const handleValidate = async comment => {\n    if (!selected) return;\n    await handleAction(selected, \"validee_en_cours_implementation\", comment);\n    setSelected(null);\n  };\n  const handleRefuse = async comment => {\n    if (!selected) return;\n    await handleAction(selected, \"refusee\", comment);\n    setSelected(null);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Tableau de bord Administrateur\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: logout,\n        className: \"logout-btn\",\n        children: \"D\\xE9connexion\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-msg\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-msg\",\n      children: success\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Toutes les demandes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Chargement...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(AdminDemandeList, {\n      demandes: demandes,\n      onSelect: setSelected,\n      onAction: handleAction\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(AdminDemandeDetail, {\n      demande: selected,\n      onClose: () => setSelected(null),\n      onValidate: handleValidate,\n      onRefuse: handleRefuse\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s(AdminDashboard, \"z19lD+UrwfWFyTgyWk1Htacu0ms=\", false, function () {\n  return [useAuth];\n});\n_c = AdminDashboard;\nexport default AdminDashboard;\nvar _c;\n$RefreshReg$(_c, \"AdminDashboard\");","map":{"version":3,"names":["React","useEffect","useState","useAuth","requestsApi","AdminDemandeList","AdminDemandeDetail","jsxDEV","_jsxDEV","AdminDashboard","_s","user","logout","demandes","setDemandes","loading","setLoading","selected","setSelected","error","setError","success","setSuccess","fetchDemandes","token","localStorage","getItem","res","getAll","id","role","data","e","handleAction","demande","status","update","_e$response","_e$response$data","response","message","handleValidate","comment","handleRefuse","className","children","style","display","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onSelect","onAction","onClose","onValidate","onRefuse","_c","$RefreshReg$"],"sources":["C:/Users/enzor/OneDrive/Документы/EPSI/SN2/projet reseau/frontend/src/pages/AdminDashboard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport requestsApi from \"../services/requests\";\r\nimport AdminDemandeList from \"../components/admin/AdminDemandeList\";\r\nimport AdminDemandeDetail from \"../components/admin/AdminDemandeDetail\";\r\n\r\nconst AdminDashboard = () => {\r\n  const { user, logout } = useAuth();\r\n  const [demandes, setDemandes] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [selected, setSelected] = useState(null);\r\n  const [error, setError] = useState(\"\");\r\n  const [success, setSuccess] = useState(\"\");\r\n\r\n  const fetchDemandes = async () => {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      const res = await requestsApi.getAll(token, user.id, user.role);\r\n      setDemandes(res.data);\r\n    } catch (e) {\r\n      setError(\"Erreur lors du chargement des demandes\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) fetchDemandes();\r\n    // eslint-disable-next-line\r\n  }, [user]);\r\n\r\n  const handleAction = async (demande, status) => {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    setSuccess(\"\");\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      await requestsApi.update(demande.id, { status }, token);\r\n      setSuccess(\"Demande mise à jour\");\r\n      fetchDemandes();\r\n    } catch (e) {\r\n      setError(e.response?.data?.message || \"Erreur lors de la mise à jour\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleValidate = async (comment) => {\r\n    if (!selected) return;\r\n    await handleAction(selected, \"validee_en_cours_implementation\", comment);\r\n    setSelected(null);\r\n  };\r\n  const handleRefuse = async (comment) => {\r\n    if (!selected) return;\r\n    await handleAction(selected, \"refusee\", comment);\r\n    setSelected(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <div\r\n        style={{\r\n          display: \"flex\",\r\n          justifyContent: \"space-between\",\r\n          alignItems: \"center\",\r\n        }}\r\n      >\r\n        <h1>Tableau de bord Administrateur</h1>\r\n        <button onClick={logout} className=\"logout-btn\">\r\n          Déconnexion\r\n        </button>\r\n      </div>\r\n      {error && <div className=\"error-msg\">{error}</div>}\r\n      {success && <div className=\"success-msg\">{success}</div>}\r\n      <h2>Toutes les demandes</h2>\r\n      {loading ? (\r\n        <p>Chargement...</p>\r\n      ) : (\r\n        <AdminDemandeList\r\n          demandes={demandes}\r\n          onSelect={setSelected}\r\n          onAction={handleAction}\r\n        />\r\n      )}\r\n      <AdminDemandeDetail\r\n        demande={selected}\r\n        onClose={() => setSelected(null)}\r\n        onValidate={handleValidate}\r\n        onRefuse={handleRefuse}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,OAAO,QAAQ,wBAAwB;AAChD,OAAOC,WAAW,MAAM,sBAAsB;AAC9C,OAAOC,gBAAgB,MAAM,sCAAsC;AACnE,OAAOC,kBAAkB,MAAM,wCAAwC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExE,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAM;IAAEC,IAAI;IAAEC;EAAO,CAAC,GAAGT,OAAO,CAAC,CAAC;EAClC,MAAM,CAACU,QAAQ,EAAEC,WAAW,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACe,QAAQ,EAAEC,WAAW,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC9C,MAAM,CAACiB,KAAK,EAAEC,QAAQ,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACmB,OAAO,EAAEC,UAAU,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EAE1C,MAAMqB,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChCP,UAAU,CAAC,IAAI,CAAC;IAChBI,QAAQ,CAAC,EAAE,CAAC;IACZ,IAAI;MACF,MAAMI,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;MAC/C,MAAMC,GAAG,GAAG,MAAMvB,WAAW,CAACwB,MAAM,CAACJ,KAAK,EAAEb,IAAI,CAACkB,EAAE,EAAElB,IAAI,CAACmB,IAAI,CAAC;MAC/DhB,WAAW,CAACa,GAAG,CAACI,IAAI,CAAC;IACvB,CAAC,CAAC,OAAOC,CAAC,EAAE;MACVZ,QAAQ,CAAC,wCAAwC,CAAC;IACpD;IACAJ,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC;EAEDf,SAAS,CAAC,MAAM;IACd,IAAIU,IAAI,EAAEY,aAAa,CAAC,CAAC;IACzB;EACF,CAAC,EAAE,CAACZ,IAAI,CAAC,CAAC;EAEV,MAAMsB,YAAY,GAAG,MAAAA,CAAOC,OAAO,EAAEC,MAAM,KAAK;IAC9CnB,UAAU,CAAC,IAAI,CAAC;IAChBI,QAAQ,CAAC,EAAE,CAAC;IACZE,UAAU,CAAC,EAAE,CAAC;IACd,IAAI;MACF,MAAME,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;MAC/C,MAAMtB,WAAW,CAACgC,MAAM,CAACF,OAAO,CAACL,EAAE,EAAE;QAAEM;MAAO,CAAC,EAAEX,KAAK,CAAC;MACvDF,UAAU,CAAC,qBAAqB,CAAC;MACjCC,aAAa,CAAC,CAAC;IACjB,CAAC,CAAC,OAAOS,CAAC,EAAE;MAAA,IAAAK,WAAA,EAAAC,gBAAA;MACVlB,QAAQ,CAAC,EAAAiB,WAAA,GAAAL,CAAC,CAACO,QAAQ,cAAAF,WAAA,wBAAAC,gBAAA,GAAVD,WAAA,CAAYN,IAAI,cAAAO,gBAAA,uBAAhBA,gBAAA,CAAkBE,OAAO,KAAI,+BAA+B,CAAC;IACxE;IACAxB,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC;EAED,MAAMyB,cAAc,GAAG,MAAOC,OAAO,IAAK;IACxC,IAAI,CAACzB,QAAQ,EAAE;IACf,MAAMgB,YAAY,CAAChB,QAAQ,EAAE,iCAAiC,EAAEyB,OAAO,CAAC;IACxExB,WAAW,CAAC,IAAI,CAAC;EACnB,CAAC;EACD,MAAMyB,YAAY,GAAG,MAAOD,OAAO,IAAK;IACtC,IAAI,CAACzB,QAAQ,EAAE;IACf,MAAMgB,YAAY,CAAChB,QAAQ,EAAE,SAAS,EAAEyB,OAAO,CAAC;IAChDxB,WAAW,CAAC,IAAI,CAAC;EACnB,CAAC;EAED,oBACEV,OAAA;IAAKoC,SAAS,EAAC,qBAAqB;IAAAC,QAAA,gBAClCrC,OAAA;MACEsC,KAAK,EAAE;QACLC,OAAO,EAAE,MAAM;QACfC,cAAc,EAAE,eAAe;QAC/BC,UAAU,EAAE;MACd,CAAE;MAAAJ,QAAA,gBAEFrC,OAAA;QAAAqC,QAAA,EAAI;MAA8B;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACvC7C,OAAA;QAAQ8C,OAAO,EAAE1C,MAAO;QAACgC,SAAS,EAAC,YAAY;QAAAC,QAAA,EAAC;MAEhD;QAAAK,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,EACLlC,KAAK,iBAAIX,OAAA;MAAKoC,SAAS,EAAC,WAAW;MAAAC,QAAA,EAAE1B;IAAK;MAAA+B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,EACjDhC,OAAO,iBAAIb,OAAA;MAAKoC,SAAS,EAAC,aAAa;MAAAC,QAAA,EAAExB;IAAO;MAAA6B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eACxD7C,OAAA;MAAAqC,QAAA,EAAI;IAAmB;MAAAK,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAC3BtC,OAAO,gBACNP,OAAA;MAAAqC,QAAA,EAAG;IAAa;MAAAK,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,gBAEpB7C,OAAA,CAACH,gBAAgB;MACfQ,QAAQ,EAAEA,QAAS;MACnB0C,QAAQ,EAAErC,WAAY;MACtBsC,QAAQ,EAAEvB;IAAa;MAAAiB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxB,CACF,eACD7C,OAAA,CAACF,kBAAkB;MACjB4B,OAAO,EAAEjB,QAAS;MAClBwC,OAAO,EAAEA,CAAA,KAAMvC,WAAW,CAAC,IAAI,CAAE;MACjCwC,UAAU,EAAEjB,cAAe;MAC3BkB,QAAQ,EAAEhB;IAAa;MAAAO,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACxB,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;AAAC3C,EAAA,CAtFID,cAAc;EAAA,QACON,OAAO;AAAA;AAAAyD,EAAA,GAD5BnD,cAAc;AAwFpB,eAAeA,cAAc;AAAC,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}