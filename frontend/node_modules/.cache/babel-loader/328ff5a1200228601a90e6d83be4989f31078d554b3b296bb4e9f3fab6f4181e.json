{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\enzor\\\\OneDrive\\\\\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B\\\\EPSI\\\\SN2\\\\projet reseau\\\\frontend\\\\src\\\\pages\\\\DemandeurDashboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useAuth } from \"../context/AuthContext\";\nimport requestsApi from \"../services/requests\";\nimport DemandeForm from \"../components/demandeur/DemandeForm\";\nimport DemandeList from \"../components/demandeur/DemandeList\";\nimport DemandeDetail from \"../components/demandeur/DemandeDetail\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DemandeurDashboard = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [demandes, setDemandes] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [showForm, setShowForm] = useState(false);\n  const [selected, setSelected] = useState(null);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n  const fetchDemandes = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      const res = await requestsApi.getAll(token, user.id, user.role);\n      setDemandes(res.data);\n    } catch (e) {\n      setError(\"Erreur lors du chargement des demandes\");\n    }\n    setLoading(false);\n  };\n  useEffect(() => {\n    if (user) fetchDemandes();\n    // eslint-disable-next-line\n  }, [user]);\n  const handleCreate = async form => {\n    setLoading(true);\n    setError(\"\");\n    setSuccess(\"\");\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      await requestsApi.create({\n        ...form,\n        user_id: user.id\n      }, token);\n      setShowForm(false);\n      setSuccess(\"Demande créée avec succès\");\n      fetchDemandes();\n    } catch (e) {\n      var _e$response, _e$response$data;\n      setError(((_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"Erreur lors de la création\");\n    }\n    setLoading(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Tableau de bord Demandeur\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-msg\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 17\n    }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-msg\",\n      children: success\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowForm(v => !v),\n      children: showForm ? \"Annuler\" : \"Nouvelle demande\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), showForm && /*#__PURE__*/_jsxDEV(DemandeForm, {\n      onSubmit: handleCreate,\n      loading: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Mes demandes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Chargement...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(DemandeList, {\n      demandes: demandes,\n      onSelect: setSelected\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(DemandeDetail, {\n      demande: selected,\n      onClose: () => setSelected(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n};\n_s(DemandeurDashboard, \"DnEhNYj/iAoJHm+Up9AGTlHP+Y0=\", false, function () {\n  return [useAuth];\n});\n_c = DemandeurDashboard;\nexport default DemandeurDashboard;\nvar _c;\n$RefreshReg$(_c, \"DemandeurDashboard\");","map":{"version":3,"names":["React","useEffect","useState","useAuth","requestsApi","DemandeForm","DemandeList","DemandeDetail","jsxDEV","_jsxDEV","DemandeurDashboard","_s","user","demandes","setDemandes","loading","setLoading","showForm","setShowForm","selected","setSelected","error","setError","success","setSuccess","fetchDemandes","token","localStorage","getItem","res","getAll","id","role","data","e","handleCreate","form","create","user_id","_e$response","_e$response$data","response","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","v","onSubmit","onSelect","demande","onClose","_c","$RefreshReg$"],"sources":["C:/Users/enzor/OneDrive/Документы/EPSI/SN2/projet reseau/frontend/src/pages/DemandeurDashboard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport requestsApi from \"../services/requests\";\r\nimport DemandeForm from \"../components/demandeur/DemandeForm\";\r\nimport DemandeList from \"../components/demandeur/DemandeList\";\r\nimport DemandeDetail from \"../components/demandeur/DemandeDetail\";\r\n\r\nconst DemandeurDashboard = () => {\r\n  const { user } = useAuth();\r\n  const [demandes, setDemandes] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [selected, setSelected] = useState(null);\r\n  const [error, setError] = useState(\"\");\r\n  const [success, setSuccess] = useState(\"\");\r\n\r\n  const fetchDemandes = async () => {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      const res = await requestsApi.getAll(token, user.id, user.role);\r\n      setDemandes(res.data);\r\n    } catch (e) {\r\n      setError(\"Erreur lors du chargement des demandes\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) fetchDemandes();\r\n    // eslint-disable-next-line\r\n  }, [user]);\r\n\r\n  const handleCreate = async (form) => {\r\n    setLoading(true);\r\n    setError(\"\");\r\n    setSuccess(\"\");\r\n    try {\r\n      const token = localStorage.getItem(\"authToken\");\r\n      await requestsApi.create({ ...form, user_id: user.id }, token);\r\n      setShowForm(false);\r\n      setSuccess(\"Demande créée avec succès\");\r\n      fetchDemandes();\r\n    } catch (e) {\r\n      setError(e.response?.data?.message || \"Erreur lors de la création\");\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <h1>Tableau de bord Demandeur</h1>\r\n      {error && <div className=\"error-msg\">{error}</div>}\r\n      {success && <div className=\"success-msg\">{success}</div>}\r\n      <button onClick={() => setShowForm((v) => !v)}>\r\n        {showForm ? \"Annuler\" : \"Nouvelle demande\"}\r\n      </button>\r\n      {showForm && <DemandeForm onSubmit={handleCreate} loading={loading} />}\r\n      <h2>Mes demandes</h2>\r\n      {loading ? (\r\n        <p>Chargement...</p>\r\n      ) : (\r\n        <DemandeList demandes={demandes} onSelect={setSelected} />\r\n      )}\r\n      <DemandeDetail demande={selected} onClose={() => setSelected(null)} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DemandeurDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}